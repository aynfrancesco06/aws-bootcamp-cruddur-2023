#! /usr/bin/env bash
set -e #stop script execution if failed

CFN_PATH="/workspace/aws-bootcamp-cruddur-2023/aws/cfn/cluster/template.yaml"
#take a template, will name it "my-cluster", no-execute-changeset will enable us to review the changes in the template

cfn-lint $CFN_PATH

aws cloudformation deploy --stack-name "CruddurCluster" \
    --template-file $CFN_PATH \
    --s3-bucket "cfn-project-artifact" \
    --no-execute-changeset \
    --tags group=cruddur-cluster \
    --capabilities CAPABILITY_NAMED_IAM 

#permission related